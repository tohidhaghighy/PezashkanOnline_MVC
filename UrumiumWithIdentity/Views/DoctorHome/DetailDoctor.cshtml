@model UrumiumMVC.ViewModel.EntityViewModel.DoctorViewModel.DoctorDetailViewModel
@{
    Layout = null;
}

<!doctype html>
<html lang="en" xmlns="http://www.w3.org/1999/html" xmlns="http://www.w3.org/1999/html"
      xmlns="http://www.w3.org/1999/html" xmlns="http://www.w3.org/1999/html" xmlns="http://www.w3.org/1999/html"
      xmlns="http://www.w3.org/1999/html" xmlns="http://www.w3.org/1999/html" xmlns="http://www.w3.org/1999/html"
      xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>دکتر برمودا</title>
    <meta http-equiv="Content-Language" content="fa" />
    <link rel="icon" href="~/Content/NewDesign/img/icons.png">
    <meta name="description" content="دکتر برمودا" />
    <meta name="robots" content="noodp" />
    <meta name="description" content="" />
    <meta name="keywords" content="" />
    <meta name="author" content="دکتر برمودا" />
    <link rel="canonical" href="" />
    <link rel="canonical" href="" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="دکتر برمودا" />
    <meta property="og:description" content="" />
    <meta property="og:url" content="" />
    <meta property="og:site_name" content="" />
    <meta property="og:image" content="~/Content/NewDesign/img/Image1 (1).png" />
    <meta name="twitter:card" content="" />
    <meta name="twitter:description" content="" />
    <meta name="twitter:title" content="" />
    <link rel="stylesheet" href="~/Content/NewDesign/css/bootstrap.css">
    <link rel="stylesheet" href="~/Content/NewDesign/css/bootstrap-reboot.css">
    <link rel="stylesheet" href="~/Content/NewDesign/css/style.css">
    <link rel='stylesheet' href='https://use.fontawesome.com/releases/v5.7.0/css/all.css' integrity='sha384-lZN37f5QGtY3VHgisS14W3ExzMWZxybE1SJSEsQp9S+oqd12jhcu+A56Ebc1zFSJ' crossorigin='anonymous'>
    <!--javascript-->
    <link href="~/Content/Common/alert/sweetalert.css" rel="stylesheet" />
    <script src="~/Content/Common/alert/sweetalert.min.js"></script>
    <script src="~/Content/NewDesign/js/jquery-3.3.1.js"></script>
    <script src="~/Content/NewDesign/js/bootstrap.js"></script>
    <script src="~/Content/NewDesign/js/custom-js.js"></script>
    <meta name="theme-color" content="#2196f3" />
    <link rel="manifest" href="/manifest.json">
</head>
<body style="overflow-x: hidden;">
    <!------------header----------->
    <div class="container-fluid-header">
        <div class="row ">
            <div class="col-12 col-md-12">
                <div class="col-12">
                    <nav class="navbar navbar-expand-md navbar-light ">
                        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#mynavbar">
                            <span class="navbar-toggler-icon"></span>
                        </button>
                        <div class="collapse navbar-collapse" id="mynavbar">
                            <ul class="navbar-nav">
                                <li class="nav_item">
                                    <a href="/" class="text-red-hover nav-link mr-1 "><i class='fas fa-home'></i></a>
                                </li>
                                <p class="text-color-menu my-2">|</p>
                                <li class="nav_item">
                                    <a href="/Account/Login" class=" nav-link mx-1">ورود کاربران</a>
                                </li>
                                <p class="text-color-menu my-2">|</p>
                                <li class="nav_item">
                                    <a href="/Account/Register" class="nav-link mx-1 ">ثبت نام</a>
                                </li>
                                <p class="text-color-menu my-2">|</p>
                                <li class="nav_item">
                                    <a href="/DoctorHome/ListDoctor?groupid=0" class="nav-link mx-1 ">پزشکان برمودا درمان</a>
                                </li>
                                <p class="text-color-menu my-2">|</p>
                                <li class="nav_item ">
                                    <a href="/DoctorHome/Download" class="nav-link mx-1 ">دانلود اپلیکیشن اندروید </a>
                                </li>
                            </ul>
                        </div>
                    </nav>
                </div>
            </div>

        </div>
    </div>
    <div class="container-fluid">
        <div class="progress">
            <div class="progress-bar"></div>
        </div>
    </div>
    <!----------body--------->
    <div>
        <div class="container mt-40" style="margin-top:80px;margin-bottom:20px;">

            <h3 class="text-center" style="font-size:45px;font-weight:bold;color:rgba(0, 0, 0, 0.73);">اطلاعات پزشکی</h3>

        </div>

        <div class="container" style="margin-bottom:20px;">
            <div class="row" style="direction:rtl;">
                <div class="col-lg-4 col-md-12 col-sm-12">
                    @{
                        if (Model.Doctors.Image == "" || Model.Doctors.Image == null)
                        {
                            <img src="~/Content/Managment/dist/img/avatar3.png" alt=" @Model.Doctors.Name" class="img-responsive img-bordered" style="height:300px;width:100%;margin-left:30px;margin-right:30px; border-radius:5px;">
                        }
                        else
                        {
                            <img src="~/uploads/Doctor/@Model.Doctors.Image" alt=" @Model.Doctors.Name" class="img-responsive img-bordered" style="height:300px;width:100%;margin-left:30px;margin-right:30px; border-radius:5px;">
                        }
                    }

                </div>
                <div class="col-lg-8 col-md-12 col-sm-12">
                    <div class="card-body">
                        <!-- Grid row -->
                        <!-- Grid row -->
                        <!--Table-->
                        <table class="table table-striped">
                            <!--Table body-->
                            <tbody>
                                <tr>
                                    <td class="text-center">نام دکتر</td>
                                    <td class="text-center">@Model.Doctors.Name</td>
                                </tr>
                                <tr>
                                    <td class="text-center">تخصص</td>
                                    <td class="text-center">@Model.Doctors.Groups.Name</td>
                                </tr>
                                <tr>
                                    <td class="text-center">هزینه ویزیت</td>
                                    <td class="text-center">@Model.Doctors.Cost</td>
                                </tr>
                                <tr>
                                    <td class="text-center">ادرس</td>
                                    <td class="text-center">@Model.Doctors.Cities.Name</td>
                                </tr>
                            </tbody>
                            <!--Table body-->
                        </table>
                        <!--Table-->
                    </div>
                </div>
            </div>
        </div>

        <div class="container" style="direction:rtl;">
            <div class="row" style="margin-top:20px;border-bottom:1px solid #dcdcdc;margin-bottom:20px;position:relative;padding:11px 0 15px;">
                <h2><span style="font-weight:bold; float:right;border-bottom:3px solid #0094ff;position:relative;padding-bottom:15px;top:16px;">درباره دکتر</span></h2>
            </div>
            <div class="row">
                <p style="text-align:right;direction:rtl;color:rgba(0, 0, 0, 0.62);font-weight:bold;">
                    @Model.Doctors.Description
                </p>
            </div>
        </div>

        @{
            if (Model.DoctorDays.Count() > 0)
            {
                <div class="container" style="direction:rtl;">
                    <div class="row" style="margin-top:20px;border-bottom:1px solid #dcdcdc;margin-bottom:20px;position:relative;padding:11px 0 15px;">
                        <h2><span style="font-weight:bold; float:right;border-bottom:3px solid #0094ff;position:relative;padding-bottom:15px;top:16px;">زمان ملاقات</span></h2>
                    </div>
                    <div class="row">
                        <div class="col-lg-12 col-md-12 col-sm-12">
                            <div class="card-body">
                                <!-- Grid row -->
                                <!-- Grid row -->
                                <!--Table-->
                                <table class="table table-striped">
                                    <thead>
                                    <th class="text-center">تاریخ</th>
                                    <th class="text-center">ساعت ملاقات</th>
                                    <th class="text-center">تعداد تایم باقی مانده</th>
                                    <th class="text-center"></th>
                                    </thead>
                                    <!--Table body-->
                                    <tbody>
                                        @{
                                            foreach (var item in Model.DoctorDays)
                                            {
                                                if (item.CountVisit != 0)
                                                {
                                                <tr>
                                                    <td class="text-center">@item.ReservePersianDatetime</td>
                                                    <td class="text-center">@item.TimeVisit</td>
                                                    <td class="text-center">@item.CountVisit  <h3>نفر</h3></td>
                                                   
                                                    @{

                                                        if (User.Identity.IsAuthenticated)
                                                        {
                                                                <td class="text-center"><button type="button" class="btn btn-success" onclick="reservetime(@item.Id,@item.DoctorId,'@item.ReserveEnglishDatetime')">رزرو وقت ملاقات</button></td>
                                                        }
                                                        else
                                                        {
                                                                <td class="text-center"><button type="button" class="btn btn-success" onclick="showmodal()">رزرو وقت ملاقات</button></td>
                                                        }

                                                    }

                                                </tr>
                                                                }
                                                            }
                                                        }
                                    </tbody>
                                    <!--Table body-->
                                </table>
                                <!--Table-->
                            </div>
                        </div>


                    </div>
                </div>
                                                        }
        }



    </div>
    <!----------footer------>
    <div class="container-fluid footer mt-5">
        <div class="row ">
            <div class="col-55 col-md-7">
                <div class="row ml-5">
                    <nav class="navbar navbar-expand-md ">
                        <ul class="navbar-nav">
                            <li class="nav_item">
                                <a href="#" class="text-red-hover nav-link mr-1 ">قوانین</a>
                            </li>
                            <p class="text-dark my-2 d-none d-sm-block">|</p>
                            
                            <li class="nav_item">
                                <a href="#" class="nav-link mx-1 ">درباره ما</a>
                            </li>
                            <p class="text-dark my-2 d-none d-sm-block">|</p>
                            <li class="nav_item">
                                <a href="#" class="nav-link mx-1 ">همکاری با ما</a>
                            </li>
                        </ul>
                    </nav>
                </div>
            </div>
            <div class="col-6 col-md-4 ">
                <div class="row float-right mt-2">
                    <a href="#" class="mx-1 my-2 text-dark"><i class='fab fa-telegram-plane'></i></a>
                    <p class="my-2 d-none d-sm-block">|</p>
                    <a href="#" class="mx-1 my-2 text-dark"><i class='fab fa-instagram'></i></a>
                </div>
            </div>
        </div>
    </div>


    <div id="myModal" class="modal fade" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title"></h4>
                </div>

                <div class="modal-body">
                    <div class="row">
                        <div class="">
                            <div class="col-12 text-center center-block">
                                <div class="row">
                                    <strong></strong>
                                    <h4 class="text-center">برای رزرو وقت پزشکی باید در سایت ثبت نام کنید</h4>
                                </div>

                            </div>
                        </div>


                    </div>
                    <br />


                </div>
                <div class="modal-footer">
                    <a name="btninsert" class="btn btn-warning" value="ثبت نام" href="/Account/Register">ثبت نام</a>
                    <a name="btninsert" class="btn btn-success" value="ورود به سایت" href="/Account/Login">ورود به سایت</a>
                </div>
            </div>

        </div>
    </div>

    <div id="myModalPayment" class="modal fade" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title"></h4>
                </div>

                <div class="modal-body">
                    <input type="number" class="form-control" style="display:none;" id="txtvisitid">
                    <input type="text" class="form-control" style="display:none;" id="txtdatetime">
                    <input type="number" class="form-control" style="display:none;" id="txtdoctorid">
                    <div class="row">
                        <div class="">
                            <div class="col-12 text-center center-block">
                                <div class="row">
                                    <strong></strong>
                                    <h3 class="text-center">شما برای رزرو وقت پزشکی باید مبلغ زیر را واریز کنید</h3>
                                </div>
                                <h4 class="" style="padding:20px;">مبلغ پرداختی</h4>
                                <h4 class="" style="color:red;margin-top:5px;">@Model.Doctors.Cost </h4>
                                <h4 class="" style="color:red;margin-top:5px;"> تومان</h4>

                            </div>
                        </div>

                    </div>
                    <br />


                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">خروج</button>
                    <a name="btninsert" class="btn btn-warning" value="پرداخت" onclick="showTaiidemodalpay()">پرداخت</a>
                </div>
            </div>

        </div>
    </div>

    <div id="myTaiidModalPayment" class="modal fade" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title"></h4>
                </div>

                <div class="modal-body">
                    <div class="row">
                        <div class="">
                            <div class="col-12 text-center center-block">
                                <div class="row">
                                    <strong></strong>
                                    <h3 class="text-center">بیمار محترم ایا قبلا به پزشک مورد نظر مراجعه کرده اید ؟</h3>
                                </div>
                            </div>
                        </div>

                    </div>
                    <br />


                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">خروج</button>
                    <a name="btninsert" class="btn btn-warning" value="پرداخت" onclick="payandsetvisit()">پرداخت</a>
                </div>
            </div>

        </div>
    </div>
    <script>
        function showmodal() {
            $("#myModal").modal();
        }

        function showmodalpay() {
            $("#myModalPayment").modal();
        }

        function showTaiidemodalpay() {
            $("#myModalPayment").modal('hide');
            $("#myTaiidModalPayment").modal();
        }


        function payandsetvisit() {
            var id=$("#txtvisitid").val();
            var doctorid = $("#txtdoctorid").val();
            var date= $("#txtdatetime").val();
            $.ajax({
                type: "Post",
                url: '/Visit/AddVisit',
                data: { id: id, doctorid: doctorid ,date:date},
                success: function (data) {
                    if (data.success) {
                        $("#myModalPayment").modal('hide');
                        swal("انجام شد", "پرداخت با موفقیت انجام شد", "success");
                        window.location.reload();
                    }
                }
            });
        }

      
        function reservetime(id, doctorid, date) {
            $("#txtvisitid").val(id);
            $("#txtdoctorid").val(doctorid); 
            $("#txtdatetime").val(date);
            $("#myModalPayment").modal();
        }
    </script>

    <script>
          if ('serviceWorker' in navigator) {
              navigator.serviceWorker
                  .register('/serviceworker.js')
                  .then(function () { console.log('Service Worker Registered'); });
          }
    </script>


</body>
</html>
