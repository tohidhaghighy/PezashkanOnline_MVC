(function(){function r(b){for(var e=0,m=0,h=0,a,n=b.$.rows.length;h<n;h++){a=b.$.rows[h];for(var d=e=0,c,f=a.cells.length;d<f;d++)c=a.cells[d],e+=c.colSpan;e>m&&(m=e)}return m}function h(b){return function(){var e=this.getValue();(e=!!(CKEDITOR.dialog.validate.integer()(e)&&0<e))||(alert(b),this.select());return e}}function p(b,e){var m=function(a){return new CKEDITOR.dom.element(a,b.document)},p=b.editable();return{title:b.lang.table.title,minWidth:310,minHeight:CKEDITOR.env.ie?270:240,onLoad:function(){var a=
this,b=a.getContentElement("advanced","advStyles");if(b)b.on("change",function(){var b=this.getStyle("width",""),c=a.getContentElement("info","txtWidth");c&&c.setValue(b,!0);b=this.getStyle("height","");(c=a.getContentElement("info","txtHeight"))&&c.setValue(b,!0)})},onShow:function(){var a=b.getSelection(),n=a.getRanges(),d,c=this.getContentElement("info","txtRows"),f=this.getContentElement("info","txtCols"),t=this.getContentElement("info","txtWidth"),g=this.getContentElement("info","txtHeight");
"tableProperties"==e&&((a=a.getSelectedElement())&&a.is("table")?d=a:0<n.length&&(CKEDITOR.env.webkit&&n[0].shrink(CKEDITOR.NODE_ELEMENT),d=b.elementPath(n[0].getCommonAncestor(!0)).contains("table",1)),this._.selectedElement=d);d?(this.setupContent(d),c&&c.disable(),f&&f.disable()):(c&&c.enable(),f&&f.enable());t&&t.onChange();g&&g.onChange()},onOk:function(){var a=b.getSelection(),n=this._.selectedElement&&a.createBookmarks(),d=this._.selectedElement||m("table"),c={};this.commitContent(c,d);if(c.info){c=
c.info;if(!this._.selectedElement)for(var f=d.append(m("tbody")),e=parseInt(c.txtRows,10)||0,g=parseInt(c.txtCols,10)||0,k=0;k<e;k++)for(var l=f.append(m("tr")),h=0;h<g;h++)l.append(m("td")).appendBogus();e=c.selHeaders;if(!d.$.tHead&&("row"==e||"both"==e)){l=new CKEDITOR.dom.element(d.$.createTHead());f=d.getElementsByTag("tbody").getItem(0);f=f.getElementsByTag("tr").getItem(0);for(k=0;k<f.getChildCount();k++)g=f.getChild(k),g.type==CKEDITOR.NODE_ELEMENT&&!g.data("cke-bookmark")&&(g.renameNode("th"),
g.setAttribute("scope","col"));l.append(f.remove())}if(null!==d.$.tHead&&"row"!=e&&"both"!=e){l=new CKEDITOR.dom.element(d.$.tHead);f=d.getElementsByTag("tbody").getItem(0);for(h=f.getFirst();0<l.getChildCount();){f=l.getFirst();for(k=0;k<f.getChildCount();k++)g=f.getChild(k),g.type==CKEDITOR.NODE_ELEMENT&&(g.renameNode("td"),g.removeAttribute("scope"));f.insertBefore(h)}l.remove()}if(!this.hasColumnHeaders&&("col"==e||"both"==e))for(l=0;l<d.$.rows.length;l++)g=new CKEDITOR.dom.element(d.$.rows[l].cells[0]),
g.renameNode("th"),g.setAttribute("scope","row");if(this.hasColumnHeaders&&"col"!=e&&"both"!=e)for(k=0;k<d.$.rows.length;k++)l=new CKEDITOR.dom.element(d.$.rows[k]),"tbody"==l.getParent().getName()&&(g=new CKEDITOR.dom.element(l.$.cells[0]),g.renameNode("td"),g.removeAttribute("scope"));c.txtHeight?d.setStyle("height",c.txtHeight):d.removeStyle("height");c.txtWidth?d.setStyle("width",c.txtWidth):d.removeStyle("width");d.getAttribute("style")||d.removeAttribute("style");c="table"+(this.getValueOf("bootstrapCssTab",
"stripedRows")?" table-striped":"");c+=this.getValueOf("bootstrapCssTab","bordered")?" table-bordered":"";c+=this.getValueOf("bootstrapCssTab","hover")?" table-hover":"";c+=this.getValueOf("bootstrapCssTab","condensed")?" table-condensed":"";d.$.className=c}if(this._.selectedElement)try{a.selectBookmarks(n)}catch(p){}else b.insertElement(d),setTimeout(function(){var a=new CKEDITOR.dom.element(d.$.rows[0].cells[0]),c=b.createRange();c.moveToPosition(a,CKEDITOR.POSITION_AFTER_START);c.select()},0)},
contents:[{id:"info",label:b.lang.table.title,elements:[{type:"hbox",children:[{type:"text",id:"txtBorder",requiredContent:"table[border]","default":"",label:b.lang.table.border,style:"display:none;",controlStyle:"width:3em;",validate:CKEDITOR.dialog.validate.number(b.lang.table.invalidBorder),setup:function(a){this.setValue(a.getAttribute("border")||"")},commit:function(a,b){this.getValue()?b.setAttribute("border",this.getValue()):b.removeAttribute("border")}}]},{type:"hbox",widths:["33.333%","33.333%",
"33.333%"],children:[{type:"text",id:"txtRows","default":3,label:b.lang.table.rows,required:!0,validate:h(b.lang.table.invalidRows),setup:function(a){this.setValue(a.$.rows.length)},commit:q},{type:"text",id:"txtCols","default":2,label:b.lang.table.columns,required:!0,validate:h(b.lang.table.invalidCols),setup:function(a){this.setValue(r(a))},commit:q},{type:"text",id:"txtWidth",requiredContent:"table{width}",label:b.lang.common.width,title:b.lang.common.cssLengthTooltip,"default":b.filter.check("table{width}")?
500>p.getSize("width")?"100%":500:0,getValue:u,validate:CKEDITOR.dialog.validate.cssLength(b.lang.common.invalidCssLength.replace("%1",b.lang.common.width)),onChange:function(){var a=this.getDialog().getContentElement("advanced","advStyles");a&&a.updateStyle("width",this.getValue())},setup:function(a){this.setValue(a.getStyle("width"))},commit:q}]},{type:"hbox",widths:["33.333%","33.333%","33.333%"],children:[{type:"text",id:"txtHeight",requiredContent:"table{height}",label:b.lang.common.height,title:b.lang.common.cssLengthTooltip,
"default":"",getValue:u,validate:CKEDITOR.dialog.validate.cssLength(b.lang.common.invalidCssLength.replace("%1",b.lang.common.height)),onChange:function(){var a=this.getDialog().getContentElement("advanced","advStyles");a&&a.updateStyle("height",this.getValue())},setup:function(a){(a=a.getStyle("height"))&&this.setValue(a)},commit:q},{type:"select",id:"selHeaders",requiredContent:"th","default":"",label:b.lang.table.headers,items:[[b.lang.table.headersNone,""],[b.lang.table.headersRow,"row"],[b.lang.table.headersColumn,
"col"],[b.lang.table.headersBoth,"both"]],setup:function(a){var b=this.getDialog();b.hasColumnHeaders=!0;for(var d=0;d<a.$.rows.length;d++){var c=a.$.rows[d].cells[0];if(c&&"th"!=c.nodeName.toLowerCase()){b.hasColumnHeaders=!1;break}}null!==a.$.tHead?this.setValue(b.hasColumnHeaders?"both":"row"):this.setValue(b.hasColumnHeaders?"col":"")},commit:q},{id:"cmbAlign",type:"select",requiredContent:"table[align]","default":"",label:b.lang.common.align,items:[[b.lang.common.notSet,""],[b.lang.common.alignLeft,
"left"],[b.lang.common.alignCenter,"center"],[b.lang.common.alignRight,"right"]],setup:function(a){this.setValue(a.getAttribute("align")||"")},commit:function(a,b){this.getValue()?b.setAttribute("align",this.getValue()):b.removeAttribute("align")}}]},{type:"vbox",children:[{type:"text",id:"txtCaption",requiredContent:"caption",label:b.lang.table.caption,setup:function(a){this.enable();a=a.getElementsByTag("caption");if(0<a.count()){a=a.getItem(0);var b=a.getFirst(CKEDITOR.dom.walker.nodeType(CKEDITOR.NODE_ELEMENT));
b&&!b.equals(a.getBogus())?(this.disable(),this.setValue(a.getText())):(a=CKEDITOR.tools.trim(a.getText()),this.setValue(a))}},commit:function(a,e){if(this.isEnabled()){var d=this.getValue(),c=e.getElementsByTag("caption");if(d)0<c.count()?(c=c.getItem(0),c.setHtml("")):(c=new CKEDITOR.dom.element("caption",b.document),e.getChildCount()?c.insertBefore(e.getFirst()):c.appendTo(e)),c.append(new CKEDITOR.dom.text(d,b.document));else if(0<c.count())for(d=c.count()-1;0<=d;d--)c.getItem(d).remove()}}},
{type:"text",id:"txtSummary",bidi:!0,requiredContent:"table[summary]",label:b.lang.table.summary,setup:function(a){this.setValue(a.getAttribute("summary")||"")},commit:function(a,b){this.getValue()?b.setAttribute("summary",this.getValue()):b.removeAttribute("summary")}}]}]},{id:"bootstrapCssTab",label:"Bootstrap CSS",elements:[{type:"hbox",widths:["50%","50%"],children:[{id:"stripedRows",label:"Striped Rows",type:"checkbox",value:"table-striped",setup:function(a){a=a.getAttribute("class").split(" ");
this.setValue(mj_in_array("table-striped",a))}},{id:"bordered",label:"Bordered",type:"checkbox",value:"table-bordered",setup:function(a){a=a.getAttribute("class").split(" ");this.setValue(mj_in_array("table-bordered",a))}}]},{type:"hbox",widths:["50%","50%"],children:[{id:"hover",label:"Hover",type:"checkbox",value:"table-hover",setup:function(a){a=a.getAttribute("class").split(" ");this.setValue(mj_in_array("table-hover",a))}},{id:"condensed",label:"Condensed",type:"checkbox",value:"table-condensed",
setup:function(a){a=a.getAttribute("class").split(" ");this.setValue(mj_in_array("table-condensed",a))}}]}]}]}}var u=CKEDITOR.tools.cssLength,q=function(b){var e=this.id;b.info||(b.info={});b.info[e]=this.getValue()};CKEDITOR.dialog.add("table",function(b){return p(b,"table")});CKEDITOR.dialog.add("tableProperties",function(b){return p(b,"tableProperties")})})();function mj_in_array(r,h){for(var p in h)if(h[p]==r)return!0;return!1};